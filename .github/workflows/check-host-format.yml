name: üß™ Check AWS_HOST Format

on:
  workflow_dispatch:

jobs:
  check_host:
    runs-on: ubuntu-latest
    steps:
      - name: üîç Check AWS_HOST Format
        run: |
          HOST="${{ secrets.AWS_HOST }}"
          
          if [[ -z "$HOST" ]]; then
            echo "‚ùå AWS_HOST is NOT SET"
            exit 1
          fi

          # Check IP Address format
          if [[ "$HOST" =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
            echo "‚úÖ AWS_HOST looks like a Public IP Address"
            exit 0
          fi

          # Check DNS format
          if [[ "$HOST" == ec2-* && "$HOST" == *.compute.amazonaws.com ]]; then
            echo "‚úÖ AWS_HOST looks like an EC2 Public DNS"
            exit 0
          fi

          # Check if URL with HTTP/HTTPS
          if [[ "$HOST" =~ ^https?:// ]]; then
            echo "‚ö†Ô∏è AWS_HOST contains http:// or https:// ‚Äî not recommended"
            exit 0
          fi

          # Otherwise:
          echo "‚ö†Ô∏è AWS_HOST is set but format is unusual. It may be invalid."
          exit 0
